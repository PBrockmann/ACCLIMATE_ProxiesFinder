/*!
 * dc-addons v0.13.1
 *
 * 2016-04-08 11:34:39
 *
 */
!function(){"use strict";window.crossfilterServer.elasticSearch={filter:function(a,b,c,d){var e=JSON.parse(JSON.stringify(c));e.hasOwnProperty("query")||(e.query={}),e.query.hasOwnProperty("filtered")||(e.query.filtered={}),e.query.filtered.hasOwnProperty("filter")||(e.query.filtered.filter={}),e.query.filtered.filter.hasOwnProperty("bool")||(e.query.filtered.filter.bool={}),e.query.filtered.filter.bool.hasOwnProperty("must")||(e.query.filtered.filter.bool.must=[]);for(var f in a)if(f!==b&&d[f]&&a[f].length>0){var g={};Array.isArray(a[f][0])?(g.range={},g.range[d[f]]={gte:a[f][0][0]instanceof Date?d3.time.format("%Y-%m-%d %H:%M:%S")(a[f][0][0]):a[f][0][0],lte:a[f][0][1]instanceof Date?d3.time.format("%Y-%m-%d %H:%M:%S")(a[f][0][1]):a[f][0][1]},e.query.filtered.filter.bool.must.push(g)):(g.terms={},g.terms[d[f]]=a[f],e.query.filtered.filter.bool.must.push(g))}return JSON.stringify(e)},send:function(a,b,c,d,e,f){var g=this.filter(a,b,d,e);d3.xhr(c).post(g,function(a,b){var c=JSON.parse(b.responseText);f(c)})}}}();